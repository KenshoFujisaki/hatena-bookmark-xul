<?xml version="1.0" encoding="utf-8"?>
<bindings xmlns="http://www.mozilla.org/xbl"
          xmlns:xbl="http://www.mozilla.org/xbl"
          xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

    <binding id="tooltip"
             extends="chrome://global/content/bindings/popup.xml#tooltip">
        <content>
            <xul:label anonid="titleField"/>
            <xul:label anonid="urlField"/>
            <xul:label anonid="commentField"/>
        </content>

        <implementation>
            <field name="titleField">
                document.getAnonymousElementByAttribute(this, "anonid", "titleField")
            </field>
            <field name="urlField">
                document.getAnonymousElementByAttribute(this, "anonid", "urlField")
            </field>
            <field name="commentField">
                document.getAnonymousElementByAttribute(this, "anonid", "commentField")
            </field>
        </implementation>

        <handlers>
            <handler event="popupshowing">
                let target = document.tooltipNode;
                let bookmark = ("hoveredBookmark" in target)
                    ? target.hoveredBookmark : target.bookmark;
                if (!bookmark) return false;
                this.titleField.value = bookmark.title;
                this.urlField.value = bookmark.url;
                this.urlField.hidden = (bookmark.title === bookmark.url);
                this.commentField.value = bookmark.comment;
                this.commentField.hidden = !/\S/.test(bookmark.comment);
                return true;
            </handler>
        </handlers>
    </binding>

</bindings>
